name: Manage and Monitor MS Paint Process

on:
  schedule:
    # 16時にプロセスを開始し、6時にプロセスを終了する設定
    - cron: '0 16 * * *'
    - cron: '0 6 * * *'
    # 5分ごとにプロセスの状態を確認
    - cron: '*/5 16-23,0-5 * * *'

jobs:
  manage-and-monitor:
    runs-on: [self-hosted, windows]  # セルフホストランナーとWindows環境を指定

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Run PowerShell Script to Manage and Check Process
        id: manage_and_check_process
        shell: pwsh
        run: |
          $currentHour = (Get-Date).Hour
          if ($currentHour -eq 22) {
            .\path\to\your\manage-and-check-process.ps1 -Action start
          } elseif ($currentHour -eq 6) {
            .\path\to\your\manage-and-check-process.ps1 -Action stop
          } else {
            .\path\to\your\manage-and-check-process.ps1 -Action check
          }

      - name: Notify Process Management
        if: failure()  # プロセス管理に失敗した場合
        run: |
          echo "MS Paint プロセスの管理に失敗しました。"
